
/* Safe Area Inset Variables and Base Styles */
:root {
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
  --status-bar-height: 0px;
  --nav-bar-height: 4rem;
  --keyboard-height: 0px;
  
  /* Calculated safe areas */
  --calculated-safe-area-top: var(--safe-area-inset-top);
  --calculated-safe-area-bottom: var(--safe-area-inset-bottom);
  --calculated-safe-area-left: var(--safe-area-inset-left);
  --calculated-safe-area-right: var(--safe-area-inset-right);
}

/* Platform detection and adjustments */
.platform-android {
  --status-bar-height: 24px;
  /* Ensure minimum safe area bottom for navigation gestures */
  --safe-area-inset-bottom: max(env(safe-area-inset-bottom, 0px), 12px);
  --calculated-safe-area-bottom: max(env(safe-area-inset-bottom, 0px), 12px);
}

.platform-ios {
  --status-bar-height: 44px;
}

/* Keyboard state management */
.keyboard-visible {
  --effective-safe-area-bottom: 0px;
}

.keyboard-visible.platform-ios {
  --effective-safe-area-bottom: var(--calculated-safe-area-bottom);
}

.keyboard-visible.platform-android {
  --effective-safe-area-bottom: 0px;
}

/* Safe area utilities */
.safe-area-top {
  padding-top: max(var(--status-bar-height), var(--calculated-safe-area-top)) !important;
}

.safe-area-bottom {
  padding-bottom: var(--calculated-safe-area-bottom) !important;
}

.safe-area-left {
  padding-left: max(8px, var(--calculated-safe-area-left)) !important;
}

.safe-area-right {
  padding-right: max(8px, var(--calculated-safe-area-right)) !important;
}

/* Mobile container base styles */
.mobile-container {
  min-height: 100vh;
  min-height: 100dvh;
  box-sizing: border-box;
  overflow-x: hidden;
  position: relative;
}

/* Apply safe areas to main app containers */
.smart-chat-container,
.journal-container,
.insights-container,
.settings-container {
  @apply safe-area-top safe-area-left safe-area-right mobile-container;
}

/* Ensure proper safe area handling for all page containers */
.journal-container,
.insights-container,
.settings-container {
  padding-top: max(var(--status-bar-height), var(--calculated-safe-area-top));
  padding-left: max(16px, var(--calculated-safe-area-left));
  padding-right: max(16px, var(--calculated-safe-area-right));
  padding-bottom: max(16px, var(--calculated-safe-area-bottom));
}

/* Chat page specific safe area handling */
.smart-chat-container {
  padding-top: max(var(--status-bar-height), var(--calculated-safe-area-top));
  padding-left: 0; /* Chat has its own padding system */
  padding-right: 0; /* Chat has its own padding system */
  padding-bottom: 0; /* Chat has its own bottom handling */
}

/* Mobile chat interface safe area handling */
.mobile-chat-interface {
  height: 100vh;
  height: 100dvh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.mobile-chat-interface .mobile-chat-content {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
  padding-top: 8px; /* Header handles top padding */
  padding-left: max(16px, var(--calculated-safe-area-left));
  padding-right: max(16px, var(--calculated-safe-area-right));
  padding-bottom: 8px;
}

.mobile-chat-interface .mobile-chat-input-container {
  background: hsl(var(--background));
  border-top: 1px solid hsl(var(--border));
  padding: 16px;
  padding-left: max(16px, var(--calculated-safe-area-left));
  padding-right: max(16px, var(--calculated-safe-area-right));
  padding-bottom: max(16px, calc(var(--calculated-safe-area-bottom) + 8px));
}

/* Platform-specific adjustments for mobile chat */
.platform-android .mobile-chat-input-container {
  padding-bottom: max(16px, calc(var(--calculated-safe-area-bottom) + 8px));
}

.platform-ios .mobile-chat-input-container {
  padding-bottom: max(16px, calc(var(--calculated-safe-area-bottom) + 8px));
}

/* Keyboard state adjustments */
.keyboard-visible .mobile-chat-input-container {
  padding-bottom: 16px;
}

.keyboard-visible.platform-ios .mobile-chat-input-container {
  padding-bottom: max(16px, var(--calculated-safe-area-bottom));
}

.keyboard-visible.platform-android .mobile-chat-input-container {
  padding-bottom: 16px;
}

/* Ensure consistent header safe area handling */
.mobile-chat-interface .sticky.top-0 {
  padding-top: max(var(--status-bar-height), var(--calculated-safe-area-top));
  padding-left: max(16px, var(--calculated-safe-area-left));
  padding-right: max(16px, var(--calculated-safe-area-right));
}

/* Handle fullscreen components like SoulNet */
.fullscreen-overlay {
  position: fixed;
  top: var(--calculated-safe-area-top);
  left: var(--calculated-safe-area-left);
  right: var(--calculated-safe-area-right);
  bottom: var(--calculated-safe-area-bottom);
  z-index: 9999;
  background: hsl(var(--background));
}
