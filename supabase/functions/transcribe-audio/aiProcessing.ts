// Import necessary Deno modules
import { encode as base64Encode } from "https://deno.land/std@0.132.0/encoding/base64.ts";

/**
 * Transcribe audio using OpenAI's Whisper API with enhanced error handling and language detection
 * @param audioBlob - The audio blob to transcribe
 * @param fileType - The audio file type (webm, mp4, wav, etc.)
 * @param apiKey - The OpenAI API key
 * @param language - The language code or 'auto' for auto-detection
 * @returns Transcribed text and detected languages
 */
export async function transcribeAudioWithWhisper(
  audioBlob: Blob,
  fileType: string,
  apiKey: string,
  language: string = 'auto'
): Promise<{ text: string; detectedLanguages: string[] }> {
  try {
    // Determine the appropriate filename extension based on audio type
    const fileExtension = fileType === 'webm' ? 'webm' : 
                         fileType === 'mp4' ? 'm4a' :
                         fileType === 'wav' ? 'wav' : 'ogg';
    
    // Prepare the audio file with an appropriate name for the OpenAI API
    const filename = `audio.${fileExtension}`;
    console.log("[Transcription] Using filename:", filename);
    
    // Convert the blob to an ArrayBuffer
    const arrayBuffer = await audioBlob.arrayBuffer();
    const audioBytes = new Uint8Array(arrayBuffer);
    
    console.log("[Transcription] Preparing audio for OpenAI:", {
      blobSize: audioBlob.size,
      blobType: audioBlob.type,
      fileExtension
    });
    
    // Create form data to send to the OpenAI API
    const formData = new FormData();
    formData.append("file", new Blob([audioBytes], { type: audioBlob.type }), filename);
    formData.append("model", "whisper-1"); // FIXED: Use correct Whisper model
    
    // Only add language parameter if it's not 'auto' and is a valid language code
    if (language !== 'auto' && language.length === 2) {
      formData.append("language", language);
    }
    
    // FIXED: Use 'json' response format instead of 'verbose_json'
    formData.append("response_format", "json");
    
    console.log("[Transcription] Sending request to OpenAI with:", {
      fileSize: audioBlob.size,
      fileType: audioBlob.type,
      fileExtension,
      hasApiKey: !!apiKey,
      model: "whisper-1",
      autoLanguageDetection: language === 'auto',
      responseFormat: "json"
    });
    
    // Call the OpenAI API for transcription with retry logic
    let response;
    let attempts = 0;
    const maxAttempts = 3;
    
    while (attempts < maxAttempts) {
      try {
        response = await fetch("https://api.openai.com/v1/audio/transcriptions", {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${apiKey}`
          },
          body: formData
        });
        
        if (response.ok) {
          break; // Success, exit retry loop
        }
        
        const errorText = await response.text();
        console.error(`[Transcription] OpenAI API error (attempt ${attempts + 1}):`, errorText);
        
        // If it's a client error (4xx), don't retry
        if (response.status >= 400 && response.status < 500) {
          throw new Error(`OpenAI API client error: ${errorText}`);
        }
        
        // For server errors (5xx), retry after a delay
        if (attempts < maxAttempts - 1) {
          const delay = Math.pow(2, attempts) * 1000; // Exponential backoff
          console.log(`[Transcription] Retrying in ${delay}ms...`);
          await new Promise(resolve => setTimeout(resolve, delay));
        }
        
        attempts++;
      } catch (fetchError) {
        console.error(`[Transcription] Network error (attempt ${attempts + 1}):`, fetchError);
        attempts++;
        
        if (attempts < maxAttempts) {
          const delay = Math.pow(2, attempts) * 1000;
          await new Promise(resolve => setTimeout(resolve, delay));
        } else {
          throw new Error(`Network error after ${maxAttempts} attempts: ${fetchError.message}`);
        }
      }
    }
    
    if (!response || !response.ok) {
      throw new Error(`Failed to transcribe audio after ${maxAttempts} attempts`);
    }
    
    // Parse the response
    const result = await response.json();
    
    // Get the transcribed text from the result
    const transcribedText = result.text || "";
    
    if (!transcribedText || transcribedText.trim().length === 0) {
      throw new Error("Transcription returned empty result");
    }
    
    // Enhanced language detection from transcribed text
    const detectedLanguages = detectLanguageFromText(transcribedText);
    
    console.log("[Transcription] Success:", {
      textLength: transcribedText.length,
      sampleText: transcribedText.substring(0, 50) + "...",
      model: "whisper-1",
      detectedLanguage: detectedLanguages[0] || 'unknown',
      allDetectedLanguages: detectedLanguages
    });
    
    return {
      text: transcribedText,
      detectedLanguages
    };
  } catch (error) {
    console.error("[Transcription] Error:", error);
    throw new Error(`Transcription failed: ${error.message}`);
  }
}

/**
 * Enhanced language detection from text patterns with better accuracy
 */
function detectLanguageFromText(text: string): string[] {
  if (!text || text.trim().length === 0) {
    return ['unknown'];
  }
  
  const detectedLanguages: string[] = [];
  const normalizedText = text.toLowerCase();
  
  // Enhanced patterns for different languages with better detection
  const languagePatterns = {
    // Script-based detection (most reliable)
    'hi': /[\u0900-\u097F]/,        // Devanagari script (Hindi)
    'bn': /[\u0980-\u09FF]/,        // Bengali script
    'te': /[\u0C00-\u0C7F]/,        // Telugu script
    'ta': /[\u0B80-\u0BFF]/,        // Tamil script
    'gu': /[\u0A80-\u0AFF]/,        // Gujarati script
    'kn': /[\u0C80-\u0CFF]/,        // Kannada script
    'ml': /[\u0D00-\u0D7F]/,        // Malayalam script
    'or': /[\u0B00-\u0B7F]/,        // Oriya script
    'pa': /[\u0A00-\u0A7F]/,        // Gurmukhi script (Punjabi)
    'mr': /[\u0900-\u097F]/,        // Marathi (also uses Devanagari)
    'zh': /[\u4e00-\u9fff]/,        // Chinese characters
    'ja': /[\u3040-\u309f\u30a0-\u30ff\u4e00-\u9fff]/, // Japanese
    'ko': /[\uac00-\ud7af]/,        // Korean
    'ar': /[\u0600-\u06FF]/,        // Arabic script
    'ru': /[\u0400-\u04FF]/,        // Cyrillic script
    
    // Word-based detection for Latin script languages
    'fr': /\b(le|la|les|un|une|des|je|tu|il|elle|nous|vous|ils|elles|et|ou|mais|donc|car|ni|or|avec|dans|pour|sur|par|sans|sous|entre|vers|chez|depuis|pendant|avant|après|très|plus|moins|bien|mal|tout|tous|toute|toutes|même|autre|autres|cette|cette|celui|celle|ceux|celles)\b/gi,
    'es': /\b(el|la|los|las|un|una|y|o|pero|que|de|en|es|por|para|con|sin|sobre|bajo|entre|hasta|desde|durante|según|como|cuando|donde|mientras|aunque|porque|si|no|sí|muy|más|menos|bien|mal|todo|toda|todos|todas|esto|esta|este|eso|esa|ese|aquel|aquella|aquellos|aquellas)\b/gi,
    'de': /\b(der|die|das|ein|eine|und|oder|aber|dass|von|zu|mit|auf|für|durch|über|unter|zwischen|während|wegen|trotz|ohne|gegen|um|nach|vor|bei|seit|bis|als|wenn|weil|obwohl|damit|so|sehr|mehr|weniger|gut|schlecht|alle|alles|dieser|diese|dieses|jener|jene|jenes)\b/gi,
    'it': /\b(il|la|lo|gli|le|un|una|e|o|ma|che|di|in|è|per|con|su|da|tra|fra|durante|secondo|come|quando|dove|mentre|anche|se|non|sì|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molti|molt
